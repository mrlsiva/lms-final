(window["webpackJsonplms-fleet"]=window["webpackJsonplms-fleet"]||[]).push([[0],{43:function(e,a,t){},51:function(e,a,t){e.exports=t(78)},56:function(e,a,t){},78:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(19),s=t.n(r),o=t(22),c=t(17),i=(t(56),t(12)),u=t(13),m=t(15),d=t(14),p=t(16),v=t(86),h=t(5),E=Object(h.k)({isAuthenticated:!1,activeUser:"Guest",empAppliedLeaves:[]}),g=t(10),b=t(23),f=Object(g.b)("Store")(Object(g.c)(function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(m.a)(this,Object(d.a)(a).call(this,e))).logoutHandler=function(){b.post("http://localhost:3000/api/user").send({name:"Guest"}).set("accept","json").end(function(e,a){console.log("User request: ",a,e)})},t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"componentDidMount",value:function(){b.get("http://localhost:3000/api/list").end(function(e,a){if(e)throw e;var t=JSON.parse(a.body);console.log("Response: ",t),t.activeUser&&(E.activeUser=t.activeUser)})}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(v.a,{bg:"light",variant:"light"},l.a.createElement(v.a.Brand,{href:"/"},"Company Name"),l.a.createElement(v.a.Toggle,null),l.a.createElement(v.a.Collapse,{className:"justify-content-end"},l.a.createElement(v.a.Text,null,"Signed in as: ",E.activeUser," | ",l.a.createElement("a",{href:"http://localhost:5000/api/logout",onClick:this.logoutHandler},this.props.logout)),l.a.createElement(v.a.Text,null))))}}]),a}(l.a.Component))),y=(t(43),t(80)),O=t(81),L=t(48),j=t(87),S=t(82),C=t(83),D=(t(72),t(44)),U=t(23),w=t(35),x=Object(g.b)("Store")(Object(g.c)(function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(m.a)(this,Object(d.a)(a).call(this,e))).handleCancel=function(e){console.log(e.target.value),console.log("Applied Leaves: ",t.state.appliedLeaves);t.state.appliedLeaves;U.post("http://localhost:3000/api/cancel").send({reqId:e.target.value,empid:t.state.empid}).set("accept","json").end(function(e,a){console.log("User request: ",a,e);var n=w.findLastIndex(t.state.appliedLeaves,function(e){return e.id==a.text}),l=JSON.parse(JSON.stringify(t.state.appliedLeaves));l[n].status="Canceled";var r=t.state.userDetails;r.availableLeave=t.state.userDetails.availableLeave+1,t.setState({appliedLeaves:l,userDetails:r})})},t.state={empid:"",role:"",userDetails:{},appliedLeaves:[]},t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"componentDidUpdate",value:function(){console.log("Component Updated!!")}},{key:"componentDidMount",value:function(){var e=this;U.get("http://localhost:3000/api/list").end(function(a,t){if(a)throw a;var n=JSON.parse(t.body);if(console.log("Response: ",n),n.activeUser){E.activeUser=n.activeUser;var l=w.find(n.users,["name",n.activeUser]),r=l.role,s=l.empid;console.log("getUser: ",l,s);var o=w.find(n[r],["empid",s]);if("employee"===r){var c=o.appliedLeaves;e.setState({appliedLeaves:e.state.appliedLeaves.concat(c)})}e.setState({role:r,userDetails:o,empid:l.empid}),E.userDetails=o}})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement(f,{name:"test",logout:"logout"}),l.a.createElement(y.a,null,l.a.createElement(O.a,null,l.a.createElement(L.a,null,"\xa0")),"employee"===this.state.role?l.a.createElement(j.a,{variant:"secondary"},l.a.createElement(O.a,null,l.a.createElement(L.a,{xs:!0,lg:"10"},"Available number of leave"),l.a.createElement(L.a,{xs:!0,lg:"2"},this.state.userDetails.availableLeave))):"",l.a.createElement(j.a,null,l.a.createElement(O.a,null,l.a.createElement(L.a,{xs:!0,lg:"10",className:"heading2"},"employee"===this.state.role?l.a.createElement("h4",null,"Leave Application List"):l.a.createElement("h4",null,"Leave Application Request List")),l.a.createElement(L.a,{xs:!0,lg:"2"},"employee"===this.state.role?l.a.createElement(S.a,{variant:"primary"},l.a.createElement("a",{href:"/apply"},"Apply for leave")):""))),l.a.createElement(O.a,null,l.a.createElement(L.a,null,l.a.createElement(C.a,{striped:!0,bordered:!0,hover:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Reason"),l.a.createElement("th",null,"Status"),l.a.createElement("th",null,"Action"))),l.a.createElement("tbody",null,this.state.appliedLeaves.map(function(a,t){return l.a.createElement("tr",{key:t},l.a.createElement("td",null,D(a.appliedOn,"mediumDate")),l.a.createElement("td",null,a.appliedFor),l.a.createElement("td",null,l.a.createElement(S.a,{variant:"Applied"===a.status?"primary":"Approved"===a.status?"success":"Canceled"===a.status?"warning":"danger"},a.status)),l.a.createElement("td",null,"Applied"===a.status?l.a.createElement(S.a,{variant:"danger"},l.a.createElement("button",{value:a.id,onClick:e.handleCancel},"Cancel")):""))})))))))}}]),a}(l.a.Component))),k=t(28),N=t(84),A=t(85),q=t(44),J=t(23),I=t(35),R=Object(g.b)("Store")(Object(g.c)(function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(m.a)(this,Object(d.a)(a).call(this,e))).handleChange=function(e){t.setState(Object(k.a)({},e.target.id,e.target.value))},t.handleSubmit=function(e){if(e.preventDefault(),t.state.availableLeaves>0){console.log("UserDetails: ",t.state.department),J.post("http://localhost:3000/api/apply").send({requestedBy:t.state.empName,empid:t.state.empid,department:t.state.department,reason:t.state.reason,requestedOn:q(t.state.dateOn,"mediumDate")}).set("accept","json").end(function(e,a){console.log("User request: ",a);var n=JSON.parse(a.text);console.log("Response: ",n),t.setState({applied:!0,availableLeaves:n.leave,reason:"",dateOn:""})})}else t.setState({limitExceeds:!0,reason:"",dateOn:""})},t.state={empid:"",empName:"",department:"",role:"",userDetails:{},appliedLeaves:[],minDate:(new Date).toISOString().split("T")[0],reason:"",dateOn:"",applied:!1,availableLeaves:0,limitExceeds:!1},t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"componentDidUpdate",value:function(){console.log("Component Updated!!")}},{key:"componentDidMount",value:function(){var e=this;J.get("http://localhost:3000/api/list").end(function(a,t){if(a)throw a;var n=JSON.parse(t.body);if(console.log("Response: ",n),n.activeUser){E.activeUser=n.activeUser;var l=I.find(n.users,["name",n.activeUser]),r=l.role,s=l.empid,o=l.name,c=l.department;console.log("getUser: ",l,s);var i=I.find(n[r],["empid",s]);if("employee"==r){var u=i.appliedLeaves;e.setState({appliedLeaves:e.state.appliedLeaves.concat(u),availableLeaves:i.availableLeave})}e.setState({role:r,userDetails:i,empid:l.empid,empName:o,department:c}),E.userDetails=i}})}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(f,{name:"test",logout:"logout"}),l.a.createElement(y.a,null,l.a.createElement(O.a,null,l.a.createElement(L.a,null,"\xa0")),l.a.createElement(j.a,{variant:"secondary"},l.a.createElement(O.a,null,l.a.createElement(L.a,{xs:!0,lg:"10"},"Available number of leave"),l.a.createElement(L.a,{xs:!0,lg:"2"},this.state.availableLeaves))),this.state.limitExceeds?l.a.createElement(j.a,{variant:"danger"},"Leaves not available in your basket! Please contact your manager."):"",l.a.createElement(j.a,null,l.a.createElement(O.a,null,l.a.createElement(L.a,{xs:!0,lg:"10",className:"heading2"},l.a.createElement("h4",null,"Apply for leave")),l.a.createElement(L.a,{xs:!0,lg:"2"},l.a.createElement(o.b,{to:"/dashboard"},l.a.createElement(N.a,null,"Dashboard"))))),l.a.createElement(O.a,null,l.a.createElement(L.a,{lg:1},"\xa0"),l.a.createElement(L.a,{lg:4},l.a.createElement(A.a,{onSubmit:this.handleSubmit},l.a.createElement(A.a.Group,{controlId:"dateOn"},l.a.createElement(A.a.Label,null,"Date"),l.a.createElement(A.a.Control,{type:"date",placeholder:"Choose a date",min:this.state.minDate,required:!0,autoFocus:!0,value:this.state.dateOn,onChange:this.handleChange})),l.a.createElement(A.a.Group,{controlId:"reason"},l.a.createElement(A.a.Label,null,"Reason"),l.a.createElement(A.a.Control,{type:"text",placeholder:"Reason",required:!0,value:this.state.reason,onChange:this.handleChange})),l.a.createElement(N.a,{variant:"primary",type:"submit"},"Submit"))),l.a.createElement(L.a,{lg:7},"\xa0"))))}}]),a}(l.a.Component))),G=t(23),B=t(35),M=function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(m.a)(this,Object(d.a)(a).call(this,e))).handleChange=function(e){t.setState(Object(k.a)({},e.target.id,e.target.value))},t.handleSubmit=function(e){e.preventDefault();G.get("http://localhost:3000/api/list").end(function(e,a){if(e)throw e;var n=JSON.parse(a.body);console.log("data: ",n.users," && ",t.state.userName);var l=B.find(n.users,["name",t.state.userName]);console.log("getUser: ",l.password),l&&l.password===t.state.password?(t.setState({isAuthenticated:!0,loginErr:!1}),E.activeUser=l.name):t.setState({isAuthenticated:!1,loginErr:!0})})},t.state={date:new Date,isAuthenticated:!1,userName:"",password:"",loginErr:!1},t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){G.post("http://localhost:3000/api/user").send({name:this.state.userName}).set("accept","json").end(function(e,a){console.log("User request: ",a,e)})}},{key:"render",value:function(){return!0===this.state.isAuthenticated?l.a.createElement(c.a,{to:"/dashboard"}):l.a.createElement("div",null,l.a.createElement(f,{name:"Guest"}),l.a.createElement(y.a,null,l.a.createElement(O.a,null,l.a.createElement(L.a,null,"\xa0")),this.state.loginErr?l.a.createElement(j.a,{variant:"danger"},l.a.createElement(O.a,null,l.a.createElement(L.a,{xs:!0,lg:"12"},"Please enter valid credentials!"))):"",l.a.createElement(O.a,null,l.a.createElement(L.a,{lg:"4"}),l.a.createElement(L.a,{lg:"4"},l.a.createElement(A.a,{onSubmit:this.handleSubmit},l.a.createElement(A.a.Group,{controlId:"userName"},l.a.createElement(A.a.Label,null,"Username"),l.a.createElement(A.a.Control,{autoFocus:!0,type:"text",placeholder:"Enter name",required:!0,value:this.state.userName,onChange:this.handleChange})),l.a.createElement(A.a.Group,{controlId:"password"},l.a.createElement(A.a.Label,null,"Password"),l.a.createElement(A.a.Control,{type:"password",placeholder:"Password",required:!0,onChange:this.handleChange})),l.a.createElement(N.a,{variant:"primary",type:"submit"},"Submit"))),l.a.createElement(L.a,{lg:"4"}))))}}]),a}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(77);var P=l.a.createElement(g.a,{Store:E},l.a.createElement(o.a,null,l.a.createElement("div",null,l.a.createElement(c.b,{exact:!0,path:"/",component:M}),l.a.createElement(c.b,{path:"/dashboard",component:x}),l.a.createElement(c.b,{path:"/apply",component:R}))));s.a.render(P,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[51,1,2]]]);
//# sourceMappingURL=main.d2d7744c.chunk.js.map